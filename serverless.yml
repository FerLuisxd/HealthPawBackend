service: 
    name: health-paw-backend

plugins:
    - serverless-webpack
    - serverless-plugin-optimize
    - serverless-offline

provider:
  name: aws
  tracing:
      apiGateway: true
  runtime: nodejs12.x
  memorySize: 256
  stage: ${opt:stage, 'dev'}
  region: us-east-1
  environment:
      PERSONS_TABLE_NAME: ${self:custom.PersonsTable.name}
  iamRoleStatements:
      - ${file(iam/PersonsTableIAM.yml):PersonsTableIAM}

package:
    individually: true

resources:
    Resources:
        PersonsTable: ${file(resources/PersonsTable.yml):PersonsTable}

functions:
  main:
    handler: src/main.handler
    events:
        - http:
            method: any
            path: /{proxy+}

custom:
    PersonsTable:
        name: !Ref PersonsTable
        arn: !GetAtt PersonsTable.Arn